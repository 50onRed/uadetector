<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Oct 8, 2014
 | Rendered using Apache Maven Fluido Skin 1.2.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
		Known Issues when using UADetector</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

          
                
        <?xml version="1.0" encoding="UTF-8"?>
<meta content="user-agent detection, detect user-agents, detect robots, detect mobile browser, mobile browser detection, mobile phone detection, java" name="keywords"/>
          
      <meta name="author" content="André Rouél" />
    <meta name="Date-Revision-yyyymmdd" content="20141008" />
    <meta http-equiv="Content-Language" content="en" />
    
          <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-31080371-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/before/uadetector">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;"
        src="https://a248.e.akamai.net/assets.github.com/img/7afbc8b248c68eb468279e8c17986ad46549fb71/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="./" id="bannerLeft" title="Logo of UADetector">
                                                                                                <img src="images/dragonfly.png"  alt="Logo of UADetector"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="./" title="UADetector">UADetector</a>
        <li class="divider ">/</li>
      </li>
    <li class="">
		Known Issues when using UADetector</li>
      
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2014-10-08</li> <li class="divider pull-right">|</li>
              <li id="projectVersion" class="pull-right">Version: 2014.10-SNAPSHOT</li>
            
                  </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                                    <h3>Overview</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="About">About</a>
            </li>
                  <li class="none">
                          <a href="usage.html" title="Usage">Usage</a>
            </li>
                  <li class="none">
                          <a href="download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="license.html" title="License">License</a>
            </li>
                  <li class="none">
                          <a href="team-list.html" title="Team">Team</a>
            </li>
                  <li class="none">
                          <a href="third-party-licenses.html" title="Third Party Licenses">Third Party Licenses</a>
            </li>
          </ul>
                        <h3>Examples</h3>
                  <ul>
                  <li class="none">
                          <a href="quickstart.html" title="Quick Start with Maven">Quick Start with Maven</a>
            </li>
                  <li class="none">
                          <a href="usage.html#usage_in_a_servlet" title="Usage in a Servlet">Usage in a Servlet</a>
            </li>
                  <li class="none">
                          <a href="usage.html#improve_performance" title="Improve Performance by Caching">Improve Performance by Caching</a>
            </li>
                  <li class="none">
                          <a href="usage.html#undeploy" title="Redeploying / Undeploying UADetector">Redeploying / Undeploying UADetector</a>
            </li>
                  <li class="none">
                          <a href="building.html" title="Building UADetector">Building UADetector</a>
            </li>
          </ul>
                        <h3>Modules</h3>
                  <ul>
                  <li class="none">
                          <a href="modules/uadetector-core/index.html" title="Core">Core</a>
            </li>
                  <li class="none">
                          <a href="modules/uadetector-resources/index.html" title="Resources">Resources</a>
            </li>
          </ul>
                        <h3>Project Documentation</h3>
                  <ul>
                  <li class="none">
                          <a href="dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a>
            </li>
                  <li class="none">
                          <a href="dependency-management.html" title="Dependency Management">Dependency Management</a>
            </li>
                  <li class="none">
                          <a href="issue-tracking.html" title="Issue Tracking">Issue Tracking</a>
            </li>
                  <li class="none">
            <strong>Known Issues</strong>
          </li>
                  <li class="none">
                          <a href="plugin-management.html" title="Plugin Management">Plugin Management</a>
            </li>
                  <li class="none">
                          <a href="plugins.html" title="Plugins">Plugins</a>
            </li>
                  <li class="none">
                          <a href="project-summary.html" title="Summary">Summary</a>
            </li>
                  <li class="none">
                          <a href="source-repository.html" title="Source Repository">Source Repository</a>
            </li>
          </ul>
                  <ul>
                  <li class="none">
                          <a href="http://sourceforge.net/projects/uadetector/" class="externalLink" title="Project page at SourceForge">Project page at SourceForge</a>
            </li>
          </ul>
                      
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="span2 search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://uadetector.sourceforge.net/" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="http://www.sourceforge.net/" title="Hosted by SourceForge" class="poweredBy">
        <img class="poweredBy"  alt="Hosted by SourceForge" src="http://sourceforge.net/sflogo.php?group_id=16035&type=1"    />
      </a>
                                                                                                    <a href="http://user-agent-string.info/" title="Analyze UA" class="poweredBy">
        <img class="poweredBy"  alt="Analyze UA" src="http://user-agent-string.info/pub/img/logo.png"    />
      </a>
                      </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span9" >
                                  
            
	
		<div class="section"><h2>Known Issues<a name="Known_Issues"></a></h2>
			<div class="knownIssues"><h3 class="knownIssues">Element type &quot;devices&quot; must be declared<a name="Element_type_devices_must_be_declared"></a></h3>
				<table border="0" class="table knownIssues">
					<tr class="a">
						<th>Issue Description</th>
						<td>
							The log contains a message that reading of
							<i>UAS data</i>
							failed, because
							<i>Element type &quot;devices&quot; must be declared.</i>
							<div class="log"><pre>22:35:02 [update-operation] WARN  n.s.u.internal.data.XmlDataHandler - Error while reading UAS data: Element type &quot;devices&quot; must be declared. (line: 20917)
22:35:02 [update-operation] WARN  n.s.u.datareader.XmlDataReader - Element type &quot;devices&quot; must be declared.
Exception in thread &quot;update-operation&quot; net.sf.qualitycheck.exception.IllegalStateOfArgumentException: The passed arguments have caused an invalid state: Argument 'data' must not be empty.
    at net.sf.uadetector.datastore.AbstractRefreshableDataStore.checkData(AbstractRefreshableDataStore.java:61)
    at net.sf.uadetector.datastore.AbstractRefreshableDataStore.setData(AbstractRefreshableDataStore.java:229)
    at net.sf.uadetector.datastore.UpdateOperationTask.call(UpdateOperationTask.java:36)
    at net.sf.uadetector.datastore.AbstractUpdateOperation$1.run(AbstractUpdateOperation.java:197)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:695)
</pre></div>
						</td>
					</tr>
					<tr class="b">
						<th>Explanation</th>
						<td>
							Since device categorization is available within the
							<i>UAS data</i>
							beginning October 2013 all previously published versions print the described log message.
							It means that
							UADetector
							cannot work with the most recent version of the database from
							<a class="externalLink" href="http://user-agent-string.info/">http://user-agent-string.info</a>
							, because the XML schema changed. In this case the library falls back to the
							previously cached file or the
							delivered database within
							<i>uadetector-resources</i>
							.
							<br />
							Stay cool, the library continues to work normally but without updates.
							End of October 2013 an update of UADetector
							support device categorization, but you can create an snapshot from the
							sources today if you need it earlier.
						</td>
					</tr>
					<tr class="a">
						<th>Corresponding Issue</th>
						<td>
							<a class="externalLink" href="https://github.com/before/uadetector/issues/44">https://github.com/before/uadetector/issues/44</a>
						</td>
					</tr>
					<tr class="b">
						<th>Affected Versions</th>
						<td>
							&lt;=
							<tt>uadetector-core-0.9.9</tt>
							,
							<br />
							&lt;=
							<tt>uadetector-resources-2013.09</tt>
						</td>
					</tr>
				</table>
			</div>
			<div class="knownIssues"><h3 class="knownIssues">Error while reading UAS data<a name="Error_while_reading_UAS_data"></a></h3>
				<table border="0" class="table knownIssues">
					<tr class="a">
						<th>Issue Description</th>
						<td>
							The log contains a message that reading of
							<i>UAS data</i>
							failed.
							<div class="log"><pre>[2013-06-20 20:17:13] WARN  [ernal.data.XmlDataHandler] :265 - Error while reading UAS data: Document root element &quot;h1&quot;, must match DOCTYPE root &quot;null&quot;. (line: 1)
[2013-06-20 20:17:13] WARN  [.datareader.XmlDataReader] :112 - Document root element &quot;h1&quot;, must match DOCTYPE root &quot;null&quot;.
[2013-06-20 20:17:13] WARN  [perationWithCacheFileTask] :203 - The read content is faulty and can not be processed correctly.
java.lang.IllegalStateException: The read in content can not be transformed to an instance of 'Data'.
    at net.sf.uadetector.datastore.UpdateOperationWithCacheFileTask.readAndSave(UpdateOperationWithCacheFileTask.java:115)
    at net.sf.uadetector.datastore.UpdateOperationWithCacheFileTask.readDataIfNewerAvailable(UpdateOperationWithCacheFileTask.java:193)
    at net.sf.uadetector.datastore.UpdateOperationWithCacheFileTask.call(UpdateOperationWithCacheFileTask.java:183)
    at net.sf.uadetector.datastore.AbstractUpdateOperation$1.run(AbstractUpdateOperation.java:161)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
[2013-06-20 20:17:13] INFO  [perationWithCacheFileTask] :212 - Reading fallback data...
</pre></div>
						</td>
					</tr>
					<tr class="b">
						<th>Explanation</th>
						<td>
							UADetector pulls updates to its user agent database from
							<a class="externalLink" href="http://user-agent-string.info/">http://user-agent-string.info</a>
							. Sometimes the website gets overloaded or has other issues.
							<br />
							We put a lot of work into ensuring that UADetector will continue to work with a recent version of the database
							even if downloading or parsing of the latest version fails. (i.e. Don't worry about those errors if they are
							occasional and intermittent.)
						</td>
					</tr>
					<tr class="a">
						<th>Corresponding Issue</th>
						<td>
							<a class="externalLink" href="https://github.com/before/uadetector/issues/31">https://github.com/before/uadetector/issues/31</a>
						</td>
					</tr>
					<tr class="b">
						<th>Affected Versions</th>
						<td>
							&lt;=
							<tt>uadetector-core-0.9.9</tt>
							,
							<br />
							&lt;=
							<tt>uadetector-resources-2013.09</tt>
						</td>
					</tr>
				</table>
			</div>
			<div class="knownIssues"><h3 class="knownIssues">Cleanup Threads<a name="Cleanup_Threads"></a></h3>
				<table border="0" class="table knownIssues">
					<tr class="a">
						<th>Issue Description</th>
						<td>
							If an application uses an implementation of
							<tt>UserAgentStringParser</tt>
							with updating functionality like
							<tt>UADetectorServiceFactory.getCachingAndUpdatingParser()</tt>
							or
							<tt>UADetectorServiceFactory.getOnlineUpdatingParser()</tt>
							its possible to get the following warnings in
							<i>Apache Tomcat</i>
							during shutdown:
							<div class="log"><pre>Jun 18, 2013 10:18:57 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/gwx-tocs-rest] appears to have started a thread named [Thread-6] but has failed to stop it. This is very likely to create a memory leak.
Jun 18, 2013 10:18:57 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/gwx-tocs-rest] appears to have started a thread named [Thread-7] but has failed to stop it. This is very likely to create a memory leak.
Jun 18, 2013 10:18:57 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads</pre></div>
							When using a profiler you can see that
							<i>Thread-6</i>
							and
							<i>Thread-7</i>
							continue to run even though the application has been undeployed. It also causes the Classloader that no longer
							required objects of an uninstalled UADetector (within a webapp for example) will never be cleaned up during
							Garbage Collection.
						</td>
					</tr>
					<tr class="b">
						<th>Explanation</th>
						<td>
							In environments where the
							<abbr title="Java Virtual Machine">JVM</abbr>
							will never shut down while reinstalling UADetector, it is necessary to manually shutdown running
							threads.
							Therefore we provide since
							<tt>uadetector-core-0.9.6</tt>
							<a href="./modules/uadetector-core/apidocs/net/sf/uadetector/UserAgentStringParser.html#shutdown">UserAgentStringParser#shutdown()</a>
							and
							<a href="./modules/uadetector-core/apidocs/net/sf/uadetector/internal/util/ExecutorServices.html#shutdownAll">ExecutorServices#shutdownAll()</a>
							to stop running executors and schedulers if necessary.
							<br />
							A number of Dependency Injection containers support the annotation
							<a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/index.html?javax/annotation/PreDestroy.html">@PreDestroy</a>
							which is useful to indicate methods that should be called when the container is shutting down. We annotated the
							method
							<a href="./modules/uadetector-core/apidocs/net/sf/uadetector/parser/UpdatingUserAgentStringParserImpl.html#shutdown">UpdatingUserAgentStringParserImpl#shutdown()</a>
							since
							<tt>uadetector-core-0.9.10</tt>
							with it. If your container support these annotation and you registered an UserAgentStringParser with updating
							functionality as bean everything is done by convention.
						</td>
					</tr>
					<tr class="a">
						<th>Corresponding Issues</th>
						<td>
							<a class="externalLink" href="https://github.com/before/uadetector/issues/4">https://github.com/before/uadetector/issues/4</a>
							<br />
							<a class="externalLink" href="https://github.com/before/uadetector/issues/46">https://github.com/before/uadetector/issues/46</a>
						</td>
					</tr>
					<tr class="b">
						<th>Affected Versions</th>
						<td>
							&gt;=
							<tt>uadetector-core-0.5.0</tt>
							and
							&lt;=
							<tt>uadetector-core-0.9.5</tt>
							,
							<br />
							&gt;=
							<tt>uadetector-resources-2012.08</tt>
							and
							&lt;=
							<tt>uadetector-resources-2013.05</tt>
						</td>
					</tr>
				</table>
			</div>
		</div>
	

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span16">Copyright &copy;                   2011-2014.
          All Rights Reserved.      
                    
      </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/597219/widgets/project_users.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>
